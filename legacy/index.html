<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>LOD 포털</title>
<meta property="og:type" content="website">
<meta property="og:title" content="LOD 포털 - 어둠의전설 종합 도우미">
<meta property="og:description" content="파티 빈자리, 라르 계산기, DB 검색, 뉴비 가이드">
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }

  :root {
    --bg: #0f1117;
    --card: #1a1d27;
    --card-hover: #222633;
    --border: #2a2e3d;
    --text: #e1e4ed;
    --text-dim: #8b90a0;
    --accent: #6c72cb;
    --warrior: #e74c3c;
    --warrior-bg: rgba(231,76,60,0.12);
    --rogue: #9b59b6;
    --rogue-bg: rgba(155,89,182,0.12);
    --mage: #3498db;
    --mage-bg: rgba(52,152,219,0.12);
    --cleric: #f1c40f;
    --cleric-bg: rgba(241,196,15,0.12);
    --taoist: #1abc9c;
    --taoist-bg: rgba(26,188,156,0.12);
    --empty: #e67e22;
    --complete: #27ae60;
  }

  body {
    font-family: 'Segoe UI', -apple-system, sans-serif;
    background: var(--bg);
    color: var(--text);
    min-height: 100vh;
  }

  /* ── Global Header ── */
  .global-header {
    background: linear-gradient(135deg, #1a1d27 0%, #252a3a 100%);
    border-bottom: 1px solid var(--border);
    position: sticky;
    top: 0;
    z-index: 100;
    backdrop-filter: blur(10px);
  }

  .header-top {
    max-width: 1200px;
    margin: 0 auto;
    padding: 14px 24px 0;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 16px;
  }

  .logo {
    display: flex;
    align-items: center;
    gap: 12px;
    cursor: pointer;
  }

  .logo-icon {
    width: 36px;
    height: 36px;
    background: linear-gradient(135deg, var(--accent), #cb69c1);
    border-radius: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 18px;
  }

  .logo h1 {
    font-size: 18px;
    font-weight: 700;
    letter-spacing: -0.5px;
  }

  .logo h1 span { color: var(--accent); }

  /* ── Navigation Tabs ── */
  .nav-tabs {
    max-width: 1200px;
    margin: 0 auto;
    padding: 10px 24px 0;
    display: flex;
    gap: 4px;
    overflow-x: auto;
    scrollbar-width: none;
    -webkit-overflow-scrolling: touch;
  }

  .nav-tabs::-webkit-scrollbar { display: none; }

  .nav-tab {
    padding: 8px 16px;
    border-radius: 10px 10px 0 0;
    border: 1px solid transparent;
    border-bottom: none;
    background: transparent;
    color: var(--text-dim);
    cursor: pointer;
    font-size: 13px;
    font-weight: 500;
    transition: all 0.15s;
    white-space: nowrap;
    position: relative;
  }

  .nav-tab:hover { color: var(--text); background: rgba(108,114,203,0.1); }

  .nav-tab.active {
    background: var(--bg);
    color: var(--accent);
    font-weight: 600;
    border-color: var(--border);
  }

  .nav-tab.active::after {
    content: '';
    position: absolute;
    bottom: -1px;
    left: 0;
    right: 0;
    height: 1px;
    background: var(--bg);
  }

  /* ── Shared Components ── */
  .main {
    max-width: 1200px;
    margin: 0 auto;
    padding: 24px;
  }

  .section-container { min-height: 50vh; }

  /* Stats bar */
  .stats-bar {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 12px;
    margin-bottom: 24px;
  }

  .stat-card {
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 16px;
    text-align: center;
  }

  .stat-value {
    font-size: 28px;
    font-weight: 700;
    background: linear-gradient(135deg, var(--accent), #cb69c1);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }

  .stat-label {
    font-size: 12px;
    color: var(--text-dim);
    margin-top: 4px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }

  /* Chip / filter */
  .filter-chips {
    display: flex;
    gap: 6px;
    flex-wrap: wrap;
  }

  .chip {
    padding: 6px 14px;
    border-radius: 20px;
    border: 1px solid var(--border);
    background: var(--bg);
    color: var(--text-dim);
    cursor: pointer;
    font-size: 13px;
    font-weight: 500;
    transition: all 0.15s;
    white-space: nowrap;
  }

  .chip:hover { border-color: var(--accent); color: var(--text); }
  .chip.active { background: var(--accent); border-color: var(--accent); color: #fff; }
  .chip.active-warrior { background: var(--warrior); border-color: var(--warrior); color: #fff; }
  .chip.active-rogue { background: var(--rogue); border-color: var(--rogue); color: #fff; }
  .chip.active-mage { background: var(--mage); border-color: var(--mage); color: #fff; }
  .chip.active-cleric { background: var(--cleric); border-color: var(--cleric); color: #111; }
  .chip.active-taoist { background: var(--taoist); border-color: var(--taoist); color: #fff; }

  /* Cards */
  .content-card {
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 14px;
    padding: 20px;
    transition: all 0.2s;
  }

  .content-card:hover {
    border-color: var(--accent);
    transform: translateY(-1px);
    box-shadow: 0 4px 16px rgba(0,0,0,0.2);
  }

  /* Empty / Loading */
  .empty-state {
    text-align: center;
    padding: 80px 24px;
    color: var(--text-dim);
  }

  .empty-state-icon { font-size: 48px; margin-bottom: 16px; opacity: 0.3; }
  .empty-state h3 { font-size: 18px; margin-bottom: 8px; color: var(--text); }

  .loading { text-align: center; padding: 60px; }

  .spinner {
    width: 36px; height: 36px;
    border: 3px solid var(--border);
    border-top-color: var(--accent);
    border-radius: 50%;
    animation: spin 0.8s linear infinite;
    margin: 0 auto 16px;
  }

  @keyframes spin { to { transform: rotate(360deg); } }

  /* Server bar */
  .server-bar {
    background: var(--card);
    border-bottom: 1px solid var(--border);
    padding: 8px 24px;
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 13px;
  }

  .server-bar label { color: var(--text-dim); white-space: nowrap; }

  .server-bar input {
    flex: 1; max-width: 360px;
    background: var(--bg);
    border: 1px solid var(--border);
    border-radius: 6px;
    padding: 5px 10px;
    color: var(--text);
    font-size: 13px;
    font-family: monospace;
  }

  .server-bar input:focus { outline: none; border-color: var(--accent); }

  .server-bar button {
    background: var(--accent); color: #fff; border: none;
    border-radius: 6px; padding: 5px 14px; font-size: 13px;
    cursor: pointer; white-space: nowrap;
  }

  .server-bar button:hover { opacity: 0.85; }
  .server-status { width: 8px; height: 8px; border-radius: 50%; background: #555; flex-shrink: 0; }
  .server-status.ok { background: var(--complete); }
  .server-status.err { background: var(--warrior); }

  /* Notice bar */
  .notice-bar {
    background: linear-gradient(90deg, rgba(108,114,203,0.15), rgba(203,105,193,0.15));
    border-bottom: 1px solid var(--border);
    padding: 8px 24px;
    text-align: center;
    font-size: 13px;
    color: var(--text-dim);
  }

  /* ── Party Section ── */
  .party-header {
    max-width: 1200px;
    margin: 0 auto;
    padding: 16px 24px 0;
  }

  .party-controls {
    display: flex;
    align-items: center;
    gap: 12px;
    flex-wrap: wrap;
  }

  .date-nav {
    display: flex; align-items: center; gap: 4px;
    background: var(--bg);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 4px;
  }

  .date-nav button {
    background: none; border: none; color: var(--text-dim);
    cursor: pointer; padding: 6px 10px; border-radius: 7px;
    font-size: 14px; transition: all 0.15s;
  }

  .date-nav button:hover { background: var(--card-hover); color: var(--text); }

  .date-nav .date-display {
    font-size: 15px; font-weight: 600;
    padding: 6px 12px; min-width: 120px; text-align: center;
  }

  .include-complete-wrap {
    display: flex; align-items: center; gap: 6px;
    font-size: 13px; color: var(--text-dim);
    cursor: pointer; user-select: none;
  }

  .include-complete-wrap input { accent-color: var(--accent); }

  .refresh-bar {
    display: flex; align-items: center; gap: 8px;
    font-size: 12px; color: var(--text-dim);
  }

  .refresh-dot {
    width: 6px; height: 6px; border-radius: 50%;
    background: var(--complete);
    animation: blink 2s ease-in-out infinite;
  }

  @keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0.3; } }

  .filter-toggle {
    display: none; width: 100%;
    background: var(--bg); border: 1px solid var(--border);
    border-radius: 8px; padding: 8px 14px;
    color: var(--text); font-size: 13px; font-weight: 500;
    cursor: pointer; text-align: left;
    align-items: center; justify-content: space-between;
    transition: border-color 0.15s;
  }

  .filter-toggle:hover { border-color: var(--accent); }
  .filter-arrow { font-size: 10px; color: var(--text-dim); transition: transform 0.2s; }
  .filter-arrow.open { transform: rotate(180deg); }

  /* Party cards */
  .party-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(340px, 1fr));
    gap: 16px;
  }

  .party-card {
    background: var(--card); border: 1px solid var(--border);
    border-radius: 14px; padding: 20px;
    transition: all 0.2s; position: relative; overflow: hidden;
  }

  .party-card:hover {
    border-color: var(--accent);
    transform: translateY(-2px);
    box-shadow: 0 8px 24px rgba(0,0,0,0.3);
  }

  .party-card.complete { opacity: 0.5; }

  .party-card.complete::after {
    content: '\uC644\uBE44';
    position: absolute; top: 12px; right: -28px;
    background: var(--complete); color: #fff;
    font-size: 10px; font-weight: 700;
    padding: 4px 32px; transform: rotate(45deg);
    letter-spacing: 1px;
  }

  .card-top { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 14px; }
  .card-location { display: flex; align-items: center; gap: 8px; }

  .location-icon {
    width: 32px; height: 32px; border-radius: 8px;
    display: flex; align-items: center; justify-content: center;
    font-size: 16px; background: rgba(108,114,203,0.15);
  }

  .location-name { font-weight: 700; font-size: 16px; }
  .party-name { font-size: 12px; color: var(--text-dim); margin-top: 2px; }
  .card-meta { text-align: right; }
  .card-sender { font-size: 16px; font-weight: 700; color: var(--text); }
  .card-updated { font-size: 11px; color: var(--text-dim); opacity: 0.6; }

  .vacancy-summary { display: flex; gap: 6px; margin-bottom: 14px; flex-wrap: wrap; }

  .vacancy-tag {
    font-size: 11px; font-weight: 600;
    padding: 3px 10px; border-radius: 12px;
    display: flex; align-items: center; gap: 4px;
  }

  .vacancy-tag.warrior { background: var(--warrior-bg); color: var(--warrior); }
  .vacancy-tag.rogue { background: var(--rogue-bg); color: var(--rogue); }
  .vacancy-tag.mage { background: var(--mage-bg); color: var(--mage); }
  .vacancy-tag.cleric { background: var(--cleric-bg); color: var(--cleric); }
  .vacancy-tag.taoist { background: var(--taoist-bg); color: var(--taoist); }

  .slot-rows { display: flex; flex-direction: column; gap: 8px; }
  .slot-row { display: flex; align-items: center; gap: 10px; }

  .slot-job { width: 36px; font-size: 12px; font-weight: 700; text-align: center; flex-shrink: 0; }
  .slot-job.warrior { color: var(--warrior); }
  .slot-job.rogue { color: var(--rogue); }
  .slot-job.mage { color: var(--mage); }
  .slot-job.cleric { color: var(--cleric); }
  .slot-job.taoist { color: var(--taoist); }

  .slot-list { display: flex; gap: 6px; flex-wrap: wrap; flex: 1; }

  .slot {
    padding: 4px 12px; border-radius: 6px; font-size: 12px;
    font-weight: 500; border: 1px solid; min-width: 60px; text-align: center;
  }

  .slot.filled { border-color: var(--border); background: rgba(255,255,255,0.03); color: var(--text-dim); }
  .slot.empty { border-style: dashed; animation: pulse-border 2s ease-in-out infinite; }
  .slot.empty.warrior { border-color: var(--warrior); color: var(--warrior); background: var(--warrior-bg); }
  .slot.empty.rogue { border-color: var(--rogue); color: var(--rogue); background: var(--rogue-bg); }
  .slot.empty.mage { border-color: var(--mage); color: var(--mage); background: var(--mage-bg); }
  .slot.empty.cleric { border-color: var(--cleric); color: var(--cleric); background: var(--cleric-bg); }
  .slot.empty.taoist { border-color: var(--taoist); color: var(--taoist); background: var(--taoist-bg); }

  @keyframes pulse-border { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }

  .requirements { margin-top: 12px; padding-top: 10px; border-top: 1px solid var(--border); }
  .req-item { font-size: 11px; color: var(--text-dim); padding: 2px 0; }
  .req-item strong { color: var(--text); }

  .time-group { margin-bottom: 32px; }

  .time-header {
    display: flex; align-items: center; gap: 12px;
    margin-bottom: 16px; padding-bottom: 8px;
    border-bottom: 1px solid var(--border);
  }

  .time-badge {
    background: linear-gradient(135deg, var(--accent), #cb69c1);
    color: #fff; font-size: 14px; font-weight: 700;
    padding: 6px 14px; border-radius: 8px; letter-spacing: 0.5px;
  }

  .time-count { font-size: 13px; color: var(--text-dim); }

  /* ── Search Section ── */
  .search-bar {
    display: flex;
    gap: 8px;
    margin-bottom: 16px;
  }

  .search-bar input {
    flex: 1;
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 12px 16px;
    color: var(--text);
    font-size: 15px;
  }

  .search-bar input:focus { outline: none; border-color: var(--accent); }

  .search-bar input::placeholder { color: var(--text-dim); }

  .btn-primary {
    background: var(--accent); color: #fff; border: none;
    border-radius: 10px; padding: 12px 24px;
    font-size: 14px; font-weight: 600; cursor: pointer;
    transition: opacity 0.15s; white-space: nowrap;
  }

  .btn-primary:hover { opacity: 0.85; }

  .search-result-header {
    font-size: 14px; color: var(--text-dim);
    margin-bottom: 16px; padding-bottom: 8px;
    border-bottom: 1px solid var(--border);
  }

  .search-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(340px, 1fr));
    gap: 12px;
  }

  .result-header {
    display: flex; align-items: center; gap: 10px;
    margin-bottom: 10px;
  }

  .result-category {
    font-size: 11px; font-weight: 600;
    padding: 3px 10px; border-radius: 12px;
    white-space: nowrap;
  }

  .cat-item { background: rgba(231,76,60,0.12); color: var(--warrior); }
  .cat-skill { background: rgba(26,188,156,0.12); color: var(--taoist); }
  .cat-spell { background: var(--mage-bg); color: var(--mage); }

  .result-name { font-size: 16px; font-weight: 700; }
  .result-detail { font-size: 12px; color: var(--text-dim); margin-top: 4px; }

  .result-stats {
    font-size: 12px; margin-top: 6px;
    color: var(--accent); font-weight: 600;
    letter-spacing: 0.3px;
  }

  .result-desc {
    font-size: 12px; color: var(--text-dim);
    margin-top: 8px; padding-top: 8px;
    border-top: 1px solid var(--border);
    line-height: 1.5;
  }

  /* ── Calculator Section ── */
  .calc-field-group { margin-bottom: 16px; }
  .calc-label { display: block; font-size: 13px; color: var(--text-dim); margin-bottom: 6px; font-weight: 500; }

  .calc-input-wrap { display: flex; align-items: center; gap: 8px; }

  .calc-input {
    background: var(--bg); border: 1px solid var(--border); border-radius: 8px;
    padding: 10px 14px; color: var(--text); font-size: 15px; width: 100%;
    transition: border-color 0.15s;
  }
  .calc-input:focus { outline: none; border-color: var(--accent); }
  .calc-input.hp:focus { border-color: var(--warrior); }
  .calc-input.mp:focus { border-color: var(--mage); }

  .calc-unit { font-size: 13px; color: var(--text-dim); white-space: nowrap; min-width: 28px; }

  .calc-select {
    background: var(--bg); border: 1px solid var(--border); border-radius: 8px;
    padding: 10px 14px; color: var(--text); font-size: 15px; width: 100%;
    cursor: pointer;
  }
  .calc-select:focus { outline: none; border-color: var(--accent); }

  .calc-ratio-wrap { display: flex; align-items: center; gap: 8px; }
  .calc-ratio-sep { font-size: 18px; color: var(--text-dim); font-weight: 600; }

  .calc-btn { width: 100%; margin-top: 8px; padding: 14px; font-size: 15px; }

  .calc-result-card {
    background: var(--card); border: 1px solid var(--border); border-radius: 14px;
    padding: 24px; margin-bottom: 16px;
  }

  .calc-result-title {
    font-size: 16px; font-weight: 700; margin-bottom: 20px;
    padding-bottom: 12px; border-bottom: 1px solid var(--border);
  }

  .calc-result-grid {
    display: grid; grid-template-columns: 1fr 1fr; gap: 16px;
    margin-bottom: 20px;
  }

  .calc-result-item { }
  .calc-result-label { font-size: 12px; color: var(--text-dim); margin-bottom: 4px; }
  .calc-result-value { font-size: 15px; font-weight: 600; }
  .calc-result-value.accent { color: var(--accent); }
  .calc-result-value.hp-color { color: var(--warrior); }
  .calc-result-value.mp-color { color: var(--mage); }

  .calc-result-highlight {
    background: rgba(108,114,203,0.1); border: 1px solid rgba(108,114,203,0.3);
    border-radius: 10px; padding: 16px; display: flex;
    justify-content: space-between; align-items: center;
  }

  .calc-highlight-label { font-size: 14px; color: var(--text-dim); }
  .calc-highlight-value { font-size: 20px; font-weight: 700; color: var(--accent); }

  .calc-result-note { font-size: 11px; color: var(--text-dim); margin-top: 12px; opacity: 0.7; }

  .calc-progress-wrap { margin-top: 16px; }

  .calc-progress-bar {
    height: 8px; background: var(--bg); border-radius: 4px;
    overflow: hidden; margin-bottom: 6px;
  }

  .calc-progress-fill {
    height: 100%; border-radius: 4px;
    background: linear-gradient(90deg, var(--accent), #cb69c1);
    transition: width 0.3s;
  }

  .calc-progress-text { font-size: 12px; color: var(--text-dim); }

  .calc-desc {
    font-size: 14px; color: var(--text-dim); margin-bottom: 16px;
    text-align: center;
  }

  .calc-quick-btns { display: flex; gap: 4px; flex-wrap: wrap; margin-top: 6px; }

  .calc-quick-btn {
    background: var(--bg); border: 1px solid var(--border); border-radius: 6px;
    padding: 4px 8px; color: var(--text-dim); font-size: 11px;
    cursor: pointer; transition: all 0.15s; white-space: nowrap;
  }
  .calc-quick-btn:hover { border-color: var(--accent); color: var(--text); }
  .calc-quick-btn.reset { color: var(--warrior); border-color: rgba(231,76,60,0.3); }
  .calc-quick-btn.reset:hover { border-color: var(--warrior); }

  .calc-auto-tier {
    background: rgba(108,114,203,0.1); border: 1px solid rgba(108,114,203,0.2);
    border-radius: 8px; padding: 10px 14px; margin-bottom: 16px;
    display: flex; justify-content: space-between; align-items: center;
    font-size: 13px;
  }
  .calc-auto-tier .tier-value { font-weight: 700; color: var(--accent); }

  .calc-links { margin-top: 32px; }
  .calc-links-title { font-size: 14px; color: var(--text-dim); margin-bottom: 12px; }

  .calc-links-row { display: flex; gap: 12px; flex-wrap: wrap; }

  .calc-link-card {
    flex: 1; min-width: 200px;
    background: var(--card); border: 1px solid var(--border); border-radius: 10px;
    padding: 14px 16px; display: flex; align-items: center; gap: 10px;
    color: var(--text); text-decoration: none; font-size: 14px;
    transition: all 0.15s;
  }
  .calc-link-card:hover { border-color: var(--accent); transform: translateY(-1px); }
  .calc-link-icon { font-size: 20px; }
  .calc-link-arrow { margin-left: auto; color: var(--text-dim); font-size: 12px; }

  .calc-footer {
    margin-top: 24px; padding-top: 16px; border-top: 1px solid var(--border);
    font-size: 12px; color: var(--text-dim); line-height: 1.8; opacity: 0.7;
  }

  .calc-necklace {
    background: rgba(108,114,203,0.05); border: 1px solid var(--border);
    border-radius: 8px; padding: 14px; margin-bottom: 16px;
  }
  .calc-necklace-title { font-size: 12px; color: var(--text-dim); margin-bottom: 8px; }

  .calc-stepper {
    display: flex; align-items: center; gap: 8px;
  }

  .calc-step-btn {
    width: 32px; height: 32px; border-radius: 6px;
    background: var(--bg); border: 1px solid var(--border);
    color: var(--text); font-size: 16px; cursor: pointer;
    display: flex; align-items: center; justify-content: center;
    transition: border-color 0.15s;
  }
  .calc-step-btn:hover { border-color: var(--accent); }

  .calc-step-value {
    min-width: 40px; text-align: center; font-size: 18px; font-weight: 700;
    color: var(--accent);
  }

  .calc-step-label { font-size: 12px; color: var(--text-dim); margin-left: 8px; }

  /* ── Wiki Section ── */
  .wiki-intro {
    text-align: center; margin-bottom: 20px;
    font-size: 16px; font-weight: 600;
  }
  .wiki-intro-sub { font-size: 12px; color: var(--text-dim); margin-top: 4px; font-weight: 400; }

  .wiki-search { margin-bottom: 16px; position: relative; }
  .wiki-search-input {
    width: 100%; padding: 10px 14px; border-radius: 8px;
    border: 1px solid var(--border); background: var(--card);
    color: var(--text); font-size: 14px; outline: none;
    transition: border-color 0.15s;
    box-sizing: border-box;
  }
  .wiki-search-input:focus { border-color: var(--accent); }
  .wiki-search-input::placeholder { color: var(--text-dim); }
  .wiki-search-result {
    font-size: 12px; color: var(--text-dim); margin-top: 6px; padding-left: 4px;
  }

  .wiki-nav {
    display: flex; gap: 6px; flex-wrap: wrap;
    margin-bottom: 24px; justify-content: center;
  }
  .wiki-nav-chip { font-size: 12px; }

  .wiki-row {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 24px;
    margin-bottom: 8px;
  }
  .wiki-row-col { display: flex; flex-direction: column; }

  .wiki-category { margin-bottom: 28px; }

  .wiki-cat-header {
    font-size: 17px; font-weight: 700; margin-bottom: 12px;
    padding-bottom: 8px; border-bottom: 1px solid var(--border);
    display: flex; align-items: center; gap: 8px;
  }
  .wiki-cat-icon { font-size: 20px; }

  .wiki-items { display: flex; flex-direction: column; gap: 4px; }

  .wiki-item {
    background: var(--card); border: 1px solid var(--border);
    border-radius: 10px; overflow: hidden;
    transition: border-color 0.15s;
  }
  .wiki-item:hover { border-color: rgba(108,114,203,0.4); }
  .wiki-item-star { border-left: 3px solid var(--empty); }

  .wiki-item-header {
    padding: 12px 16px; cursor: pointer;
    display: flex; align-items: center; gap: 10px;
    font-size: 14px; font-weight: 500;
    transition: background 0.15s;
  }
  .wiki-item-header:hover { background: var(--card-hover); }

  .wiki-item-arrow {
    font-size: 10px; color: var(--text-dim);
    transition: transform 0.2s; flex-shrink: 0;
  }
  .wiki-item-arrow.open { transform: rotate(90deg); }

  .wiki-item-title { flex: 1; }

  .wiki-item-body {
    padding: 0 16px 14px 36px;
    font-size: 13px; line-height: 1.8; color: #c0c4d0;
  }

  .wiki-text-link {
    display: block; padding: 8px 16px;
    color: #a5a9f0; font-size: 13px;
    text-decoration: none;
  }
  .wiki-text-link:hover { text-decoration: underline; color: #c5c8f8; }

  .wiki-text-item {
    padding: 8px 16px; font-size: 13px; color: var(--text);
  }

  /* Wiki block rendering */
  .wiki-p { margin-bottom: 6px; word-break: break-word; }
  .wiki-h1 { font-size: 16px; font-weight: 700; color: var(--text); margin: 12px 0 6px; }
  .wiki-h2 { font-size: 15px; font-weight: 600; color: var(--text); margin: 10px 0 6px; }
  .wiki-h3 { font-size: 14px; font-weight: 600; color: var(--text); margin: 8px 0 4px; }
  .wiki-li { padding: 2px 0; }
  .wiki-indent { padding-left: 16px; }

  .wiki-link { color: #a5a9f0; text-decoration: none; }
  .wiki-link:hover { text-decoration: underline; color: #c5c8f8; }

  .wiki-code {
    background: rgba(108,114,203,0.15); padding: 1px 6px;
    border-radius: 4px; font-size: 12px; font-family: monospace;
  }

  .wiki-callout {
    background: rgba(108,114,203,0.08); border: 1px solid rgba(108,114,203,0.2);
    border-radius: 8px; padding: 10px 14px; margin: 6px 0;
  }

  .wiki-quote {
    border-left: 3px solid var(--accent); padding-left: 12px;
    margin: 6px 0; color: var(--text);
  }

  .wiki-divider {
    border: none; border-top: 1px solid var(--border);
    margin: 12px 0;
  }

  .wiki-image {
    margin: 10px 0; text-align: center;
  }
  .wiki-image img {
    max-width: 100%; border-radius: 8px;
    border: 1px solid var(--border);
  }
  .wiki-image-caption { font-size: 11px; color: var(--text-dim); margin-top: 4px; }

  .wiki-bookmark {
    display: inline-block; padding: 6px 14px;
    background: var(--bg); border: 1px solid var(--border);
    border-radius: 6px; color: var(--accent);
    text-decoration: none; font-size: 13px; margin: 4px 0;
  }
  .wiki-bookmark:hover { border-color: var(--accent); }

  .wiki-table-wrap { overflow-x: auto; margin: 8px 0; }
  .wiki-table {
    width: 100%; border-collapse: collapse; font-size: 12px;
  }
  .wiki-table th, .wiki-table td {
    border: 1px solid var(--border); padding: 6px 10px; text-align: left;
  }
  .wiki-table th { background: var(--card); font-weight: 600; color: var(--text); }
  .wiki-table td { color: #c0c4d0; }

  .wiki-sub-toggle { margin: 4px 0; }
  .wiki-sub-toggle-header {
    cursor: pointer; padding: 4px 0; font-weight: 500; color: var(--text);
    display: flex; align-items: center; gap: 6px;
  }
  .wiki-sub-toggle-header:hover { color: #a5a9f0; }
  .wiki-sub-toggle-body { padding-left: 20px; }

  .wiki-columns { display: flex; gap: 16px; }
  .wiki-column { flex: 1; }

  .wiki-loading { font-size: 12px; color: var(--text-dim); padding: 8px 0; }
  .wiki-error { font-size: 12px; color: var(--warrior); padding: 8px 0; }
  .wiki-empty-body { font-size: 12px; color: var(--text-dim); padding: 4px 0; opacity: 0.5; }

  .wiki-extras { display: flex; flex-wrap: wrap; gap: 8px; }
  .wiki-extra-link {
    padding: 8px 14px; background: var(--card); border: 1px solid var(--border);
    border-radius: 8px; color: var(--accent); text-decoration: none;
    font-size: 13px; transition: border-color 0.15s;
  }
  .wiki-extra-link:hover { border-color: var(--accent); }

  @media (max-width: 768px) {
    .wiki-row { grid-template-columns: 1fr; gap: 0; }
    .wiki-columns { flex-direction: column; gap: 8px; }
    .wiki-item-body { padding-left: 20px; }
  }

  /* ── Ad Container ── */
  .ad-container {
    display: flex;
    justify-content: center;
    align-items: center;
    max-width: 1200px;
    margin: 12px auto;
    padding: 0 24px;
    overflow: hidden;
  }
  .ad-container ins { max-width: 100%; }

  /* ── Responsive ── */
  @media (max-width: 768px) {
    .global-header { padding-bottom: 0; }
    .header-top { padding: 10px 12px 0; gap: 8px; }
    .logo { display: none; }
    .nav-tabs { padding: 8px 12px 0; gap: 2px; }
    .nav-tab { padding: 6px 12px; font-size: 12px; }
    .main { padding: 12px; }
    .party-header { padding: 10px 12px 0; }
    .party-grid { grid-template-columns: 1fr; }
    .search-grid { grid-template-columns: 1fr; }
    .stats-bar { grid-template-columns: repeat(2, 1fr); gap: 8px; }
    .stat-card { padding: 10px; }
    .stat-value { font-size: 22px; }
    .stat-label { font-size: 11px; }
    .party-controls { width: 100%; justify-content: space-between; }
    .date-nav { border-radius: 8px; }
    .date-nav .date-display { font-size: 14px; padding: 4px 8px; min-width: 100px; }
    .date-nav button { padding: 4px 8px; font-size: 13px; }
    .filter-toggle { display: flex; }
    .filter-body { display: none; flex-direction: column; width: 100%; padding-top: 8px; }
    .filter-body.open { display: flex; }
    .party-filter-area { flex-direction: column; padding-top: 8px !important; }
    .filter-chips {
      flex-wrap: nowrap; overflow-x: auto;
      -webkit-overflow-scrolling: touch; scrollbar-width: none;
      padding-bottom: 2px;
    }
    .filter-chips::-webkit-scrollbar { display: none; }
    .chip { padding: 4px 11px; font-size: 12px; }
    .notice-bar { padding: 6px 12px; font-size: 11px; }
    .server-bar { padding: 6px 12px; font-size: 12px; }
    .party-card { padding: 14px; border-radius: 12px; }
    .location-name { font-size: 14px; }
    .location-icon { width: 28px; height: 28px; font-size: 14px; border-radius: 6px; }
    .card-sender { font-size: 14px; }
    .time-badge { font-size: 13px; padding: 4px 10px; }
    .search-bar { flex-direction: column; }
    .search-bar input { font-size: 14px; }
    .calc-result-grid { grid-template-columns: 1fr; gap: 12px; }
    .calc-result-highlight { flex-direction: column; gap: 4px; text-align: center; }
    .ad-container { padding: 0 12px; margin: 8px auto; }
  }
</style>
</head>
<body>

<!-- Server config bar -->
<div class="server-bar" id="serverBar">
  <div class="server-status" id="serverStatus"></div>
  <label>Server:</label>
  <input type="text" id="serverUrl" placeholder="http://서버IP:3000" spellcheck="false">
  <button onclick="connectServer()">연결</button>
</div>

<!-- Notice bar (파티 탭 전용) -->
<div class="notice-bar" id="partyNoticebar">
  <span>데이터 수집상태에 따라 오차가 있으니 참고! | 제작자: 밀떡밀떡</span>
</div>

<!-- Global Header + Navigation -->
<div class="global-header">
  <div class="header-top">
    <div class="logo" onclick="navigateTo('party')">
      <div class="logo-icon">L</div>
      <h1>LOD <span>도우미</span></h1>
    </div>
  </div>
  <div class="nav-tabs">
    <button class="nav-tab active" data-section="party" onclick="navigateTo('party')">파티 빈자리</button>
    <button class="nav-tab" data-section="calc" onclick="navigateTo('calc')">라르 계산기</button>
    <button class="nav-tab" data-section="search" onclick="navigateTo('search')">DB 검색</button>
    <button class="nav-tab" data-section="wiki" onclick="navigateTo('wiki')">뉴비 가이드</button>
  </div>
</div>

<!-- Ad Banner -->
<div class="ad-container">
  <ins class="kakao_ad_area" style="display:none;"
    data-ad-unit="DAN-HZSl1WITmHno9Lir"
    data-ad-width="728"
    data-ad-height="90"></ins>
</div>

<!-- ═══ Section: 파티 빈자리 ═══ -->
<div id="section-party" class="section-container">
  <div class="party-header">
    <div class="party-controls">
      <div class="date-nav">
        <button onclick="PartyModule.changeDate(-1)" title="이전 날">&#9664;</button>
        <div class="date-display" id="partyDateDisplay"></div>
        <button onclick="PartyModule.changeDate(1)" title="다음 날">&#9654;</button>
      </div>
      <label class="include-complete-wrap">
        <input type="checkbox" id="partyIncludeComplete" onchange="PartyModule.loadParties()">
        <span>완비 포함</span>
      </label>
      <div class="refresh-bar">
        <div class="refresh-dot"></div>
        <span id="partyRefreshTimer">30s</span>
      </div>
    </div>
    <div class="party-filter-area" style="padding-top: 12px;">
      <button class="filter-toggle" onclick="PartyModule.toggleFilters()">
        <span id="partyFilterSummary">전체</span>
        <span class="filter-arrow" id="partyFilterArrow">&#9660;</span>
      </button>
      <div class="filter-body" id="partyFilterBody">
        <div class="filter-chips" id="partyFilterChips">
          <button class="chip active" onclick="PartyModule.setFilter(this, '')">전체</button>
          <button class="chip" onclick="PartyModule.setFilter(this, 'warrior')">전사</button>
          <button class="chip" onclick="PartyModule.setFilter(this, 'rogue')">도적</button>
          <button class="chip" onclick="PartyModule.setFilter(this, 'mage')">법사</button>
          <button class="chip" onclick="PartyModule.setFilter(this, 'cleric')">직자</button>
          <button class="chip" onclick="PartyModule.setFilter(this, 'taoist')">도가</button>
        </div>
        <div class="filter-chips" id="partyTimeChips" style="margin-top: 8px;">
          <button class="chip active" onclick="PartyModule.setTimeFilter(this, '')">전체 시간</button>
        </div>
      </div>
    </div>
  </div>
  <div class="main">
    <div class="stats-bar" id="partyStatsBar"></div>
    <div id="partyContent">
      <div class="loading"><div class="spinner"></div><div style="color: var(--text-dim);">불러오는 중...</div></div>
    </div>
  </div>
</div>

<!-- ═══ Section: 라르 계산기 ═══ -->
<div id="section-calc" class="section-container" style="display:none">
  <div class="main">
    <div class="calc-desc">어둠의전설 순수 HP/MP 강화에 필요한 라르를 계산해보세요</div>
    <div class="filter-chips" id="calcModeChips" style="margin-bottom: 16px;">
      <button class="chip active" data-mode="required" onclick="CalcUI.switchMode('required')">필요 라르는?</button>
      <button class="chip" data-mode="target" onclick="CalcUI.switchMode('target')">목표 단수는?</button>
      <button class="chip" data-mode="raise" onclick="CalcUI.switchMode('raise')">올릴 수 있는 수치는?</button>
      <button class="chip" data-mode="fullexp" onclick="CalcUI.switchMode('fullexp')">풀경험치 라르</button>
    </div>
    <div class="content-card" style="margin-bottom: 20px;">
      <div id="calcForm"></div>
    </div>
    <div id="calcResult"></div>
    <div class="calc-links">
      <div class="calc-links-title">다른 계산기</div>
      <div class="calc-links-row">
        <a href="https://minho83.github.io/lod_Spirit/" target="_blank" class="calc-link-card">
          <span class="calc-link-icon">&#x2728;</span>
          <span>정령 레벨업 비용 계산기</span>
          <span class="calc-link-arrow">&#x2197;</span>
        </a>
        <a href="https://minho83.github.io/horn_calculator/" target="_blank" class="calc-link-card">
          <span class="calc-link-icon">&#x1F4B0;</span>
          <span>발록뿔 손익 계산기</span>
          <span class="calc-link-arrow">&#x2197;</span>
        </a>
      </div>
    </div>
    <div class="calc-footer">
      <p>고레벨 구간(HP 555만+, MP 275만+)의 경험치 계산은 제보 데이터 기반입니다.</p>
      <p>실제 HP/MP와 단수 정보 제보: <strong>밀떡밀떡</strong> (인게임 우편) | miltteok220@gmail.com</p>
    </div>
  </div>
</div>

<!-- ═══ Section: DB 검색 ═══ -->
<div id="section-search" class="section-container" style="display:none">
  <div class="main">
    <div class="search-bar">
      <input type="text" id="searchInput" placeholder="아이템, 기술, 마법 검색... (예: 메테오, 크리스탈)" spellcheck="false">
      <button class="btn-primary" onclick="SearchModule.doSearch()">검색</button>
    </div>
    <div class="filter-chips" id="searchCategoryChips" style="margin-bottom: 20px;">
      <button class="chip active" onclick="SearchModule.setCategory(this, 'all')">전체</button>
      <button class="chip" onclick="SearchModule.setCategory(this, 'item')">아이템</button>
      <button class="chip" onclick="SearchModule.setCategory(this, 'skill')">기술</button>
      <button class="chip" onclick="SearchModule.setCategory(this, 'spell')">마법</button>
    </div>
    <div id="searchResults">
      <div class="empty-state">
        <div class="empty-state-icon">&#x1F50D;</div>
        <h3>아이템/기술/마법을 검색하세요</h3>
        <p>초성 검색도 지원합니다 (예: ㅋㄹㅅ)</p>
      </div>
    </div>
  </div>
</div>

<!-- ═══ Section: 뉴비 가이드 (Notion Wiki) ═══ -->
<div id="section-wiki" class="section-container" style="display:none">
  <div class="main">
    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:16px;">
      <div style="font-size:13px; color:var(--text-dim);">Notion 위키 연동 | 노션에서 편집하면 자동 반영됩니다</div>
      <button class="chip" onclick="WikiModule.refresh()" style="font-size:12px;">&#x1F504; 새로고침</button>
    </div>
    <div id="wikiContent">
      <div class="loading"><div class="spinner"></div><div style="color: var(--text-dim);">위키 불러오는 중...</div></div>
    </div>
  </div>
</div>

<!-- Kakao AdFit -->
<script async src="https://t1.daumcdn.net/kas/static/ba.min.js"></script>

<!-- Scripts -->
<script src="js/app.js"></script>
<script src="js/party.js"></script>
<script src="js/calculator-core.js"></script>
<script src="js/calculator-ui.js"></script>
<script src="js/search.js"></script>
<script src="js/wiki.js"></script>
</body>
</html>
